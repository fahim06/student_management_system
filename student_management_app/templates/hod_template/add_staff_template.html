{% extends 'hod_template/base_template.html' %}
{% block page_title %}
    Add Staff
{% endblock page_title %}
{% block main_content %}

    <section class="content">
        <div class="container-fluid">
            <div class="row">
                <div class="card card-primary card-outline mb-4">
                    <!--begin::Header-->
                    <div class="card-header">
                        <div class="card-title">Add Staff</div>
                    </div>
                    <!--end::Header-->
                    <!--begin::Form-->
                    <form role="form" action="/add_staff_save" method="post">
                        {% csrf_token %}
                        <!--begin::Body-->
                        <div class="card-body">
                            <div class="form-group">
                                <label class="form-label">Email address</label>
                                <input type="email" class="form-control" name="email" placeholder="Enter email"
                                       id="id_email" autocomplete="off">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Password</label>
                                <input type="password" class="form-control" name="password"
                                       placeholder="Enter password">
                            </div>
                            <div class="form-group">
                                <label class="form-label">First Name</label>
                                <input type="text" class="form-control" name="first_name"
                                       placeholder="Enter first name">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Last Name</label>
                                <input type="text" class="form-control" name="last_name" placeholder="Enter last name">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Username</label>
                                <input type="text" class="form-control" name="username" placeholder="Enter username"
                                       id="id_username" autocomplete="off">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Address</label>
                                <input type="text" class="form-control" name="address" placeholder="Enter address">
                            </div>
                            <div class="form-group>">
                                {% if messages %}
                                    {% for message in messages %}
                                        {% if message.tags == 'error' %}
                                            <div class="alert alert-danger"
                                                 style="margin-top: 10px;text-align: center ">{{ message }}</div>
                                        {% endif %}
                                        {% if message.tags == 'success' %}
                                            <div class="alert alert-success"
                                                 style="margin-top: 10px;text-align: center ">{{ message }}</div>
                                        {% endif %}
                                    {% endfor %}
                                {% endif %}
                            </div>
                        </div>
                        <!--end::Body-->
                        <!--begin::Footer-->
                        <div class="card-footer">
                            <button type="submit" class="btn btn-primary w-100">Add Staff</button>
                        </div>
                        <!--end::Footer-->
                    </form>
                    <!--end::Form-->
                </div>
            </div>
        </div>
    </section>

{% endblock main_content %}

{% block custom_js %}
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        $(document).ready(function () {
            $("#id_email").keyup(function () {
                var email = $(this).val();

                if (email != "") {
                    $.ajax({
                        url: '{% url 'check_email_exist' %}',
                        type: 'POST',
                        data: {email: email}
                    })
                        .done(function (response) {
                            console.log(response);
                            if (response == "True") {
                                $(".email_error").remove();
                                $("<span class='email_error' style='padding: 5px;color: red;font-weight: bold;'>Email Not Available</span>").insertAfter("#id_email");
                            } else {
                                $(".email_error").remove();
                                $("<span class='email_error' style='padding: 5px;color: green;font-weight: bold;'>Email Available</span>").insertAfter("#id_email");
                            }
                        })
                        .fail(function () {
                            console.log("failed");
                        })
                } else {
                    $(".email_error").remove();
                }

            });

            $("#id_username").keyup(function () {
                var username = $(this).val();

                if (username != "") {
                    $.ajax({
                        url: '{% url 'check_username_exist' %}',
                        type: 'POST',
                        data: {username: username}
                    })
                        .done(function (response) {
                            console.log(response);
                            if (response == "True") {
                                $(".username_error").remove();
                                $("<span class='username_error' style='padding: 5px;color: red;font-weight: bold;'>Username Not Available</span>").insertAfter("#id_username");
                            } else {
                                $(".username_error").remove();
                                $("<span class='username_error' style='padding: 5px;color: green;font-weight: bold;'>Username Available</span>").insertAfter("#id_username");
                            }
                        })
                        .fail(function () {
                            console.log("failed");
                        })
                } else {
                    $(".username_error").remove();
                }

            });

        });
    </script>
{% endblock custom_js %}